<%= form_with(model: grocery_list, class: "contents") do |form| %>
  <% if grocery_list.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-md mt-3">
      <h2><%= pluralize(grocery_list.errors.count, "error") %> prohibited this grocery_list from being saved:</h2>

      <ul class="list-disc ml-6">
        <% grocery_list.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

    <%= form.hidden_field :week_of,
                        required: true,
                        value: Date.today,
                        class: "block w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2.5 text-gray-900 dark:text-white border #{grocery_list.errors[:week_of].any? ? 'border-red-400 dark:border-red-600 focus:border-red-500 focus:ring-red-500/20' : 'border-gray-300 dark:border-white/10 focus:border-[#5f734c] dark:focus:border-[#7a8f62] focus:ring-[#5f734c]/20 dark:focus:ring-[#7a8f62]/20'} focus:ring-2 outline-none transition" %>

  <div class="mb-4" data-controller="searchable-select" data-searchable-select-placeholder-value="Search for an ingredient...">
    <%= form.label :ingredient_id, class: "block text-sm font-medium text-gray-900 dark:text-white mb-2" %>
    <%= form.select :ingredient_id,
                    options_for_select(
                      Ingredient.order(favorite: :desc, ingredient: :asc).map { |r|
                        [r.ingredient, r.id, { 'data-favorite' => r.favorite }]
                      },
                      grocery_list.ingredient_id
                    ),
                    { include_blank: true },
                    class: "block w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2.5 text-gray-900 dark:text-white border border-gray-300 dark:border-white/10 focus:border-[#5f734c] dark:focus:border-[#7a8f62] focus:ring-2 focus:ring-[#5f734c]/20 dark:focus:ring-[#7a8f62]/20 outline-none transition",
                    data: {
                      dynamic_filter_target: "field",
                      searchable_select_target: "select",
                      action: "change->dynamic-filter#updateValueField"
                    }
    %>
  </div>

  <div class="mb-4">
    <%= form.label :units, class: "block text-sm font-medium text-gray-900 dark:text-white mb-2" %>
    <%= form.number_field :units, value: 1, min: 1,
                          class: ["block w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2.5 text-gray-900 dark:text-white border border-gray-300 dark:border-white/10 focus:border-[#5f734c] dark:focus:border-[#7a8f62] focus:ring-2 focus:ring-[#5f734c]/20 dark:focus:ring-[#7a8f62]/20 outline-none transition", {"": grocery_list.errors[:units].none?, "border-red-400 focus:outline-red-600": grocery_list.errors[:units].any?}],
    required: true
    %>
  </div>

    <%= form.hidden_field :manually_adjusted, value: true %>

  <div class="inline">
    <%= form.submit "Add to list", class: "rounded-lg px-6 py-2.5 bg-[#5f734c] hover:bg-[#4b5a3d] dark:bg-[#7a8f62] dark:hover:bg-[#5f734c] text-white font-medium cursor-pointer transition shadow-sm" %>
  </div>
<% end %>
